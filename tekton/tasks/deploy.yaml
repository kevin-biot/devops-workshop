apiVersion: tekton.dev/v1
kind: Task
metadata:
  name: deploy
spec:
  params:
    - name: manifest-path
      type: string
      description: Path (relative to workspace) to your k8s manifests
    - name: namespace
      type: string
      description: Target namespace for deployment
  workspaces:
    - name: source
      description: The workspace containing the k8s manifests
  steps:
    - name: oc-apply
      image: registry.access.redhat.com/ubi8/ubi
      workingDir: $(workspaces.source.path)
      script: |
        #!/bin/bash
        set -e
        echo "⛓️ Applying manifests from $(params.manifest-path) to namespace $(params.namespace)"
        oc apply -f $(params.manifest-path) -n $(params.namespace)
